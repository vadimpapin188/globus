<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>–ì–ª–æ–±—É—Å - –ü–æ–∏—Å–∫ –∏ –Ω–µ —Ç–æ–ª—å–∫–æ!</title>
  <link rel="icon" href="favicon.png.png" type="image/png">
  <style>
    :root {
      --primary-color: #C0C0C0; 
      --secondary-color: #ffffff;
      --background-color: #051937; 
      --sidebar-bg: #1a2a3a;
      --sidebar-width: 200px;
    }
    body { margin: 0; font-family: Arial, sans-serif; background-color: var(--background-color); color: var(--secondary-color); display: flex; min-height: 100vh; overflow-x: hidden; }
    
    /* –°–Ω–µ–∂–∏–Ω–∫–∏ */
    .snowflake { color: #fff; font-size: 1em; position: fixed; top: -10%; z-index: 9999; animation: snowflakes-fall 10s linear infinite; }
    @keyframes snowflakes-fall { 0% { top: -10%; } 100% { top: 100%; } }

    nav.sidebar { width: var(--sidebar-width); background-color: var(--sidebar-bg); color: white; position: fixed; height: 100%; padding-top: 10px; box-sizing: border-box; z-index: 100; transition: width 0.3s; }
    nav.sidebar.collapsed { width: 50px; }
    nav.sidebar ul { list-style-type: none; padding: 0; margin: 0; }
    nav.sidebar ul li a { color: white; padding: 10px; display: block; text-decoration: none; white-space: nowrap; overflow: hidden; font-size: 14px; }
    nav.sidebar ul li a:hover { background-color: var(--primary-color); }
    
    #menu-toggle { position: absolute; top: 5px; right: -25px; background-color: var(--primary-color); color: white; border: none; padding: 5px 8px; cursor: pointer; border-radius: 5px; font-size: 12px; }
    
    .content-area { flex-grow: 1; margin-left: var(--sidebar-width); display: flex; flex-direction: column; transition: margin-left 0.3s; }
    .content-area.shifted { margin-left: 50px; }
    
    .top-bar { display: flex; justify-content: space-between; align-items: center; padding: 20px 40px; background-color: rgba(255, 255, 255, 0.05); }
    .brand-section h1 { color: var(--primary-color); font-size: 40px; margin: 0; }
    
    .search-section { display: flex; gap: 10px; }
    #search-input { padding: 10px 15px; border: 1px solid #aaa; width: 300px; border-radius: 4px; }
    #search-button { padding: 10px 20px; background-color: var(--primary-color); color: white; border: none; cursor: pointer; border-radius: 4px; font-weight: bold; }
    
    main { padding: 40px; flex-grow: 1; z-index: 10; }
    footer { text-align: center; padding: 15px; background-color: #222; color: #888; font-size: 12px; }
    
    .ai-answer-box { background: rgba(255,255,255,0.1); padding: 25px; border-radius: 12px; color: white; line-height: 1.6; font-size: 18px; border-left: 5px solid var(--primary-color); margin-top: 20px; }
    .shop-btn { padding: 15px 25px; margin-top: 15px; border: none; border-radius: 8px; cursor: pointer; font-weight: bold; color: white; margin-right: 10px; }
    .wb { background: #8d169b; }
    .dm { background: #0056b3; }
    a { color: red; text-decoration: none; }
  </style>
</head>
<body>
  <nav class="sidebar" id="sidebar">
    <button id="menu-toggle">¬´</button>
    <ul>
      <li><a href="https://vadimpapin188.github.io/globus"><span>–ì–ª–∞–≤–Ω–∞—è (–≤—ã —Ç—É—Ç)</span></a></li>
      <li><a href="#"><span>–û –Ω–∞—Å</span></a></li>
      <li><a href="#"><span>–ù–æ–≤–æ–µ</span></a></li>
      <li><a href="https://vadimpapin188.github.io/globus-news/"><span>–ù–æ–≤–æ—Å—Ç–∏</span></a></li>
    </ul>
  </nav>

  <div class="content-area" id="content-area">
    <div class="top-bar">
      <div class="brand-section"><h1>–ì–ª–æ–±—É—Å</h1></div>
      <div class="search-section">
        <input id="search-input" type="text" placeholder="...–∏ –ø–æ –≥–∞–ª–∞–∫—Ç–∏–µ–∫–µ –Ω–∞–π–¥—ë–º!">
        <button id="search-button">–ù–∞–π—Ç–∏</button>
      </div>
    </div>
    <main id="main">
      <p>–ù–∞–π–¥—ë–º –ø–æ –≤—Å–µ–π –∑–µ–º–ª–µ –∏ –∑–∞ –µ—ë –ø—Ä–µ–¥–µ–ª–∞–º–∏!</p>
    </main>
    <footer>¬© –ì–ª–æ–±—É—Å. 2025.</footer>
  </div>

  <script>
    const input = document.getElementById('search-input');
    const button = document.getElementById('search-button');
    const mainArea = document.getElementById('main');
    const sidebar = document.getElementById('sidebar');
    const toggleButton = document.getElementById('menu-toggle');
    const contentArea = document.getElementById('content-area');

    const aiTriggers = ["–∫–∞–∫", "—á—Ç–æ", "–ø–æ—á–µ–º—É", "–∑–∞—á–µ–º", "–∫—Ç–æ", "–≥–¥–µ", "–∫–æ–≥–¥–∞", "–∫–∞–∫–æ–π"];

    function createSnow() {
        const snowflake = document.createElement('div');
        snowflake.classList.add('snowflake');
        snowflake.innerHTML = '‚ùÑ';
        snowflake.style.left = Math.random() * 100 + 'vw';
        snowflake.style.animationDuration = Math.random() * 3 + 7 + 's';
        snowflake.style.opacity = Math.random();
        document.body.appendChild(snowflake);
        setTimeout(() => { snowflake.remove(); }, 10000);
    }
    setInterval(createSnow, 400);

    async function fixOrtho(query) {
        try {
            const response = await fetch(`https://speller.yandex.net/services/spellservice.json/checkText?text=${encodeURIComponent(query)}`);
            const data = await response.json();
            let correctedQuery = query;
            for (let i = data.length - 1; i >= 0; i--) {
                const error = data[i];
                if (error.s && error.s.length > 0) {
                    correctedQuery = correctedQuery.substring(0, error.pos) + error.s[0] + correctedQuery.substring(error.pos + error.len);
                }
            }
            return correctedQuery;
        } catch (e) { return query; }
    }

    async function askAI(question) {
        mainArea.innerHTML = "<h2>–ì–ª–æ–±—É—Å –ò–ò</h2><p>–í–∞–¥–∏–º, –ø–æ–¥–∫–ª—é—á–∞—é—Å—å –∫ —Å–∫–æ—Ä–æ—Å—Ç–Ω–æ–º—É –∫–∞–Ω–∞–ª—É... –°–µ–∫—É–Ω–¥—É!</p>";
        try {
            const aiResponse = await fetch("https://openrouter.ai/api/v1/chat/completions", {
                method: "POST",
                headers: { "Content-Type": "application/json" },
                body: JSON.stringify({
                    "model": "mistralai/mistral-7b-instruct:free",
                    "messages": [
                        {"role": "system", "content": "–¢—ã ‚Äî —Å–µ—Ä—å–µ–∑–Ω—ã–π –ò–ò —Å–∏—Å—Ç–µ–º—ã –ì–ª–æ–±—É—Å. –û—Ç–≤–µ—á–∞–π —Ç–æ–ª—å–∫–æ –Ω–∞ —Ä—É—Å—Å–∫–æ–º."},
                        {"role": "user", "content": question}
                    ]
                })
            });
            const data = await aiResponse.json();
            const aiAnswer = data.choices[0].message.content;
            mainArea.innerHTML = `<h2>ü§ñ –û—Ç–≤–µ—Ç –ì–ª–æ–±—É—Å-–ò–ò</h2><div class="ai-answer-box">${aiAnswer.trim().replace(/\n/g, '<br>')}</div>`;
        } catch (error) {
            mainArea.innerHTML = `<h2>–û—à–∏–±–∫–∞</h2><button class="shop-btn dm" onclick="window.location.href='https://www.google.com/search?q=${question}'">–ù–∞–π—Ç–∏ –≤ Google</button>`;
        }
    }

    async function search() {
    let rawQuery = input.value.trim();
    if (!rawQuery) return alert('–í–≤–µ–¥–∏—Ç–µ –∑–∞–ø—Ä–æ—Å!');
    
    button.disabled = true;
    button.textContent = '...';
    
    // 1. –ò—Å–ø—Ä–∞–≤–ª—è–µ–º –æ—Ä—Ñ–æ–≥—Ä–∞—Ñ–∏—é
    let finalQuery = await fixOrtho(rawQuery);
    
    // 2. –ü–µ—Ä–µ–≤–æ–¥ –≤ –Ω–∏–∂–Ω–∏–π —Ä–µ–≥–∏—Å—Ç—Ä
    finalQuery = finalQuery.toLowerCase();
    
    // 3. –£–¥–∞–ª–µ–Ω–∏–µ –∑–Ω–∞–∫–æ–≤ –ø—Ä–µ–ø–∏–Ω–∞–Ω–∏—è (–æ—Å—Ç–∞–≤–ª—è–µ–º —Ç–æ–ª—å–∫–æ –±—É–∫–≤—ã, —Ü–∏—Ñ—Ä—ã –∏ –ø—Ä–æ–±–µ–ª—ã)
    // –≠—Ç–æ —É–±–µ—Ä–µ—Ç ?, !, ., ,, :, ; –∏ –ø—Ä–æ—á–∏–µ —Å–∏–º–≤–æ–ª—ã
    finalQuery = finalQuery.replace(/[^\w\s–∞-—è—ë0-9]/gi, '');
    
    input.value = finalQuery;
    
    let firstWord = finalQuery.split(' ')[0];

    if (aiTriggers.includes(firstWord)) {
        await askAI(finalQuery);
    } else if (finalQuery.includes("–æ–¥–µ–∂–¥–∞")) {
        mainArea.innerHTML = `<h2>–ì–ª–æ–±—É—Å –ú–∞—Ä–∫–µ—Ç</h2><button class="shop-btn wb" onclick="window.location.href='https://www.wildberries.ru/catalog/0/search.aspx?search=${finalQuery}'">Wildberries</button><button class="shop-btn dm" onclick="window.location.href='https://www.detmir.ru/search/results/?qt=${finalQuery}'">–î–µ—Ç—Å–∫–∏–π –ú–∏—Ä</button>`;
    } else {
        // 4. –ó–∞–º–µ–Ω–∞ –ø—Ä–æ–±–µ–ª–æ–≤ –Ω–∞ –¥–µ—Ñ–∏—Å—ã –¥–ª—è URL
        let slugQuery = finalQuery.replace(/\s+/g, '-');
        window.location.href = 'https://sites.google.com/view/globushomett/' + encodeURIComponent(slugQuery);
    }
    
    button.disabled = false;
    button.textContent = '–ù–∞–π—Ç–∏';
}

    button.addEventListener('click', search);
    input.addEventListener('keydown', (e) => { if (e.key === 'Enter') search(); });
    toggleButton.addEventListener('click', () => {
        const isCollapsed = sidebar.classList.toggle('collapsed');
        contentArea.classList.toggle('shifted', isCollapsed);
        toggleButton.textContent = isCollapsed ? '¬ª' : '¬´';
    });
  </script>
</body>
</html>

