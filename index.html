<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>–ì–ª–æ–±—É—Å - –ü–æ–∏—Å–∫–æ–≤–∏–∫ –Ω–∞ –≤—Å–µ 100%</title>
  <link rel="icon" href="favicon.png.png" type="image/png">

  <style>
    :root {
      --primary-color: #B3B1B1;
      --secondary-color: #b4b7b8;
      --background-color: #096082;
      --sidebar-bg: #444444;
      --sidebar-width: 200px;
    }

    body {
      margin: 0;
      font-family: Arial, sans-serif;
      background-color: var(--background-color);
      color: var(--secondary-color);
      display: flex;
      min-height: 100vh;
    }

    /* --- –°–ê–ô–î–ë–ê–† --- */
    nav.sidebar {
      width: var(--sidebar-width);
      background-color: var(--sidebar-bg);
      color: white;
      position: fixed;
      height: 100%;
      padding-top: 10px;
      box-sizing: border-box;
      z-index: 100;
      transition: width 0.3s;
    }

    nav.sidebar.collapsed { width: 50px; }
    nav.sidebar ul { list-style-type: none; padding: 0; margin: 0; }
    nav.sidebar ul li a {
      color: white;
      padding: 10px;
      display: block;
      text-decoration: none;
      white-space: nowrap;
      overflow: hidden;
      font-size: 14px;
    }
    nav.sidebar ul li a:hover { background-color: var(--primary-color); }
    nav.sidebar.collapsed ul li a span { display: none; }
    nav.sidebar ul li a::before { content: '‚Ä¢'; margin-right: 8px; font-weight: bold; }
    nav.sidebar.collapsed ul li a::before { margin-right: 0; display: block; text-align: center; }

    #menu-toggle {
      position: absolute;
      top: 5px;
      right: -25px;
      background-color: var(--primary-color);
      color: white;
      border: none;
      padding: 5px 8px;
      cursor: pointer;
      border-radius: 5px;
      font-size: 12px;
    }

    /* --- –ö–û–ù–¢–ï–ù–¢ --- */
    .content-area {
        flex-grow: 1;
        margin-left: var(--sidebar-width);
        display: flex;
        flex-direction: column;
        transition: margin-left 0.3s;
    }
    .content-area.shifted { margin-left: 50px; }

    .top-bar {
      display: flex;
      justify-content: space-between;
      align-items: center;
      padding: 20px 40px;
      background-color: rgba(255, 255, 255, 0.05);
    }

    .brand-section h1 { color: var(--primary-color); font-size: 40px; margin: 0; }
    .search-section { display: flex; gap: 10px; }
    #search-input { padding: 10px 15px; border: 1px solid #aaa; width: 300px; border-radius: 4px; }
    #search-button {
      padding: 10px 20px;
      background-color: var(--primary-color);
      color: white;
      border: none;
      cursor: pointer;
      border-radius: 4px;
      font-weight: bold;
    }

    main { padding: 0 40px; flex-grow: 1; }
    p { font-size: 18px; text-align: left; color: #fff; }

    footer {
      text-align: center;
      padding: 15px;
      background-color: #222;
      color: #888;
      font-size: 12px;
      border-top: 1px solid #333;
    }

    .ai-answer-box {
        background: rgba(255, 255, 255, 0.1);
        padding: 25px;
        border-radius: 12px;
        color: white;
        line-height: 1.6;
        font-size: 18px;
        border-left: 5px solid var(--primary-color);
        margin-top: 20px;
    }

    .shop-btn {
        padding: 15px 25px;
        margin-top: 15px;
        border: none;
        border-radius: 8px;
        cursor: pointer;
        font-weight: bold;
        color: white;
        margin-right: 10px;
    }
    .wb { background: #8d169b; }
    .dm { background: #0056b3; }
  </style>
</head>
<body>

  <nav class="sidebar" id="sidebar">
    <button id="menu-toggle">¬´</button>
    <ul>
      <li><a href="https://vadimpapin188.github.io/globus"><span>–ì–ª–∞–≤–Ω–∞—è</span></a></li>
      <li><a href="#"><span>–û –Ω–∞—Å</span></a></li>
      <li><a href="#"><span>–ù–æ–≤–æ–≤–≤–µ–¥–µ–Ω–∏—è</span></a></li>
      <li><a href="https://vadimpapin188.github.io/globus-news/"><span>–ù–æ–≤–æ—Å—Ç–∏ –ì–ª–æ–±—É—Å–∞</span></a></li>
    </ul>
  </nav>

  <div class="content-area" id="content-area">
    <div class="top-bar">
      <div class="brand-section">
        <h1>–ì–ª–æ–±—É—Å</h1>
      </div>
      <div class="search-section">
        <input id="search-input" type="text" placeholder="–ù–∞–π–¥—ë–º –ø–æ –≤—Å–µ–π –∑–µ–º–ª–µ –∏ –∑–∞ –µ—ë –ø—Ä–µ–¥–µ–ª–∞–º–∏!">
        <button id="search-button">–ù–∞–π—Ç–∏</button>
      </div>
    </div>

    <main id="main">
      <p>–ü—Ä–æ–µ–∫—Ç —è–≤–ª—è–µ—Ç—Å—è –Ω–µ–∫–æ–º–º–µ—Ä—á–µ—Å–∫–∏–º –∏ –∏–Ω–¥–∏-—Ä–∞–∑—Ä–∞–±–æ—Ç–∫–æ–π.</p>
    </main>

    <footer id="footer">
      ¬© –ì–ª–æ–±—É—Å. 2025.
    </footer>
  </div>

  <script>
    const input = document.getElementById('search-input');
    const button = document.getElementById('search-button');
    const sidebar = document.getElementById('sidebar');
    const toggleButton = document.getElementById('menu-toggle');
    const contentArea = document.getElementById('content-area');
    const mainArea = document.getElementById('main');

    const GEMINI_API_KEY = "AIzaSyDCKRhLTYu-f2ihgDJBunxT8hQDrP48TUE";
    const aiTriggers = ["–∫–∞–∫", "—á—Ç–æ", "–ø–æ—á–µ–º—É", "–∑–∞—á–µ–º", "–∫—Ç–æ", "–≥–¥–µ", "–∫–æ–≥–¥–∞", "–∫–∞–∫–æ–π"];

    function cleanText(text) {
        return text.trim().toLowerCase().replace(/\s+/g, ' ');
    }

    async function fixOrtho(query) {
        try {
            const response = await fetch(`https://speller.yandex.net/services/spellservice.json/checkText?text=${encodeURIComponent(query)}`);
            const data = await response.json();
            let correctedQuery = query;
            for (let i = data.length - 1; i >= 0; i--) {
                const error = data[i];
                if (error.s && error.s.length > 0) {
                    correctedQuery = correctedQuery.substring(0, error.pos) + error.s[0] + correctedQuery.substring(error.pos + error.len);
                }
            }
            return correctedQuery;
        } catch (error) { return query; }
    }

    async function askAI(question) {
        mainArea.innerHTML = "<h2>–ì–ª–æ–±—É—Å –ò–ò</h2><p>–ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ –∏–Ω—Ç–µ–ª–ª–µ–∫—Ç—É–∞–ª—å–Ω–æ–º—É —è–¥—Ä—É –ì–ª–æ–±—É—Å–∞... –ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –ø–æ–¥–æ–∂–¥–∏—Ç–µ.</p>";
        
        try {
            // –ò—Å–ø–æ–ª—å–∑—É–µ–º –ø—Ä–æ–∫—Å–∏ –¥–ª—è –æ–±—Ö–æ–¥–∞ –±–ª–æ–∫–∏—Ä–æ–≤–æ–∫ –±—Ä–∞—É–∑–µ—Ä–∞
            const proxyUrl = "https://corsproxy.io/?";
            const apiUrl = `https://generativelanguage.googleapis.com/v1beta/models/gemini-1.5-flash:generateContent?key=${GEMINI_API_KEY}`;

            const response = await fetch(proxyUrl + encodeURIComponent(apiUrl), {
                method: "POST",
                headers: { "Content-Type": "application/json" },
                body: JSON.stringify({
                    contents: [{ parts: [{ text: `–¢—ã ‚Äî –æ—Ñ–∏—Ü–∏–∞–ª—å–Ω—ã–π –ò–ò –ø–æ–∏—Å–∫–æ–≤–æ–π —Å–∏—Å—Ç–µ–º—ã –ì–ª–æ–±—É—Å. –û—Ç–≤–µ—á–∞–π —Å–µ—Ä—å–µ–∑–Ω–æ, –∏–Ω—Ñ–æ—Ä–º–∞—Ç–∏–≤–Ω–æ –∏ —Ç–æ–ª—å–∫–æ –Ω–∞ —Ä—É—Å—Å–∫–æ–º —è–∑—ã–∫–µ. –í–æ–ø—Ä–æ—Å: ${question}` }] }]
                })
            });

            const data = await response.json();
            
            if (data.candidates && data.candidates[0].content) {
                const aiAnswer = data.candidates[0].content.parts[0].text;
                mainArea.innerHTML = `
                    <h2>ü§ñ –û—Ç–≤–µ—Ç –ì–ª–æ–±—É—Å-–ò–ò</h2>
                    <div class="ai-answer-box">
                        ${aiAnswer.trim().replace(/\n/g, '<br>')}
                    </div>
                `;
            } else {
                throw new Error("–û—à–∏–±–∫–∞ –¥–∞–Ω–Ω—ã—Ö");
            }
        } catch (error) {
            mainArea.innerHTML = "<h2>–û—à–∏–±–∫–∞</h2><p>–ù–µ —É–¥–∞–ª–æ—Å—å –ø–æ–ª—É—á–∏—Ç—å –æ—Ç–≤–µ—Ç. –ü–æ–ø—Ä–æ–±—É–π—Ç–µ –Ω–∞–∂–∞—Ç—å '–ù–∞–π—Ç–∏' –µ—â–µ —Ä–∞–∑ –∏–ª–∏ –ø—Ä–æ–≤–µ—Ä—å—Ç–µ –∏–Ω—Ç–µ—Ä–Ω–µ—Ç.</p>";
        }
    }

    async function search() {
        let query = input.value;
        if (!query.trim()) return alert('–í–≤–µ–¥–∏—Ç–µ –∑–∞–ø—Ä–æ—Å!');
        query = cleanText(query);

        // –ü—Ä–æ–≤–µ—Ä–∫–∞ –õ–ì–ë–¢
        const restricted = ["–ª–≥–±—Ç", "lgbt"];
        if (restricted.some(w => query.includes(w))) {
            mainArea.innerHTML = `
                <div style="background: #fff; color: #000; padding: 20px; border-radius: 10px;">
                    <h2 style="color: red;">–û—Ç–∫–∞–∑ –ì–ª–æ–±—É—Å–∞</h2>
                    <p>–•–æ—Ç—è –ì–ª–æ–±—É—Å –ø—ã—Ç–∞–µ—Ç—Å—è –±—ã—Ç—å –æ—Ç–∫—Ä—ã—Ç—ã–º –¥–ª—è –≤—Å–µ—Ö, —ç—Ç–æ—Ç –∫–æ–Ω—Ç–µ–Ω—Ç –Ω–µ –∂–µ–ª–∞–µ—Ç –¥–æ–±—Ä–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º.</p>
                </div>
            `;
            return;
        }

        button.disabled = true;
        button.textContent = '...';

        const finalQuery = await fixOrtho(query);
        input.value = finalQuery;

        if (finalQuery.includes("–æ–¥–µ–∂–¥–∞")) {
            mainArea.innerHTML = `
                <h2>–ì–ª–æ–±—É—Å –ú–∞—Ä–∫–µ—Ç</h2>
                <p>–í—ã–±–µ—Ä–∏—Ç–µ –ø–ª–∞—Ç—Ñ–æ—Ä–º—É –¥–ª—è –ø–æ–∏—Å–∫–∞ –æ–¥–µ–∂–¥—ã:</p>
                <button class="shop-btn wb" onclick="window.location.href='https://www.wildberries.ru/catalog/0/search.aspx?search=${finalQuery}'">Wildberries</button>
                <button class="shop-btn dm" onclick="window.location.href='https://www.detmir.ru/search/results/?qt=${finalQuery}'">–î–µ—Ç—Å–∫–∏–π –ú–∏—Ä</button>
            `;
            button.disabled = false;
            button.textContent = '–ù–∞–π—Ç–∏';
            return;
        }

        const firstWord = finalQuery.split(' ')[0];
        if (aiTriggers.includes(firstWord)) {
            await askAI(finalQuery);
            button.disabled = false;
            button.textContent = '–ù–∞–π—Ç–∏';
        } else {
            window.location.href = 'https://sites.google.com/view/globushomett/' + encodeURIComponent(finalQuery);
        }
    }

    button.addEventListener('click', search);
    input.addEventListener('keydown', (e) => { if (e.key === 'Enter') search(); });

    toggleButton.addEventListener('click', () => {
        const isCollapsed = sidebar.classList.toggle('collapsed');
        contentArea.classList.toggle('shifted', isCollapsed);
        toggleButton.textContent = isCollapsed ? '¬ª' : '¬´';
    });
  </script>
</body>
</html>
